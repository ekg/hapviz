hapviz: region-bounded haplotype pileup visualization for BAM files

it all happens in the terminal!

    % hapviz --help
    usage: hapviz [options] bam file [... bam file]

    options:
        -b, --bam           bam file to from which to extract reads
                            (may also be specified as positional arguments)
        -a, --show-all      When visualizing, show all alignments, not just variant ones.
        -f, --reference     FASTA reference against which alignments have been aligned
        -q, --min-base-quality
                            minimum base quality required for all bases in a read

    Displays haplotype groups from the specified region across the BAM files provided as input.


Note: If you list 'stdin' as one of the BAM files, you can pipe BAM directly into hapviz.

This example output shows how each indel haplotype is grouped, and the reads
from it are aligned to a reference sequence.  Relative deletions between the
reference and reads are replaced by '-'.


17 i:16817:GGCAC
                                16769   CAGGGTGCTGCCCTCTCCCCAGCACTTCAGGGCTTTAGCTGGGAGGGA-----GGCAGTCCACAGGAAACCGACCCATGGACCTACTGAATTCATCACTGTAGCTGC   16870
sample03 48M5I17M                       CAGGGTGCTGCCCTCTCCCCAGCACTTCAGGGCTTTAGCTGGGAGGGAGGCACGGCAGTCCACAGGAAAC
sample02 47M5I18M                        AGGGTGCTGCCCTCTCCCCAGCACTTCAGGGCTTTAGCTGGGAGGGAGGCACGGCAGTCCACAGGAAACC
sample07 46M5I19M                         GGGTGCTGCCCTCTCCCCAGCACTTCAGGGCTTTAGCTGGGAGGGAGGCACGGCAGTCCACAGGAAACCG
sample03 43M5I22M                            TGCTGCCCTCTCCCCAGCACTTCAGGGCTTTAGCTGGGAGGGAGGCACGGCAGTCCACAGGAAACCGACC
sample05 40M5I25M                               TGCCCTCTCCCCAGCACTTCAGGGCTTTAGCTGGGAGGGAGGCACGGCAGTCCACAGGAAACCGACCCAT
sample03 40M5I25M                               TGCCCTCTCCCCAGCACTTCAGGGCTTTAGCTGGGAGGGAGGCACGGCAGTCCACAGGAAACCGACCCAT
sample08 31M5I34M                                        CCCAGCACTTCAGGGCTTTAGCTGGGAGGGAGGCACGGCAGTCCACAGGAAACCGACCCATGGACCTACT
sample03 30M5I35M                                         CCAGCACTTCAGGGCTTTAGCTGGGAGGGAGGCACGGCAGTCCACAGGAAACCGACCCATGGACCTACTG
sample02 27M5I38M                                            GCACTTCAGGGCTTTAGCTGGGAGGGAGGCACGGCAGTCCACAGGAAACCGACCCATGGACCTACTGAAT
sample05 26M5I39M                                             CACTTCAGGGCTTTAGCTGGGAGGGAGGCACGGCAGTCCACAGGAAACCGACCCATGGACCTACTGAATT
sample05 24M5I41M                                               CTTCAGGGCTTTAGCTGGGAGGGAGGCACGGCAGTCCACAGGAAACCGACCCATGGACCTACTGAATTCA
sample07 21M5I44M                                                  CAGGGCTTTAGCTGGGAGGGAGGCACGGCAGTCCACAGGAAACCGACCCATGGACCTACTGAATTCATCA
sample07 21M5I44M                                                  CAGGGCTTTAGCTGGGAGGGAGGCACGGCAGTCCACAGGAAACCGACCCATGGACCTACTGAATTCATCA
sample03 19M5I46M                                                    GGGCTTTAGCTGGGAGGGAGGCACGGCAGTCCACAGGAAACCGACCCATGGACCTACTGAATTCATCACT
sample08 14M5I51M                                                         TTAGCTGGGAGGGAGGCACGGCAGTCCACAGGAAACCGACCCATGGACCTACTGAATTCATCACTGTAGC
sample03 11M5I54M                                                            GCTGGGAGGGAGGCACGGCAGTCCACAGGAAACCGACCCATGGACCTACTGAATTCATCACTGTAGCTGC
sample07 11M5I54M                                                            GCTGGGAGGGAGGCACGGCAGTCCACAGGAAACCGACCCATGGACCTACTGAATTCATCACTGTAGCTGC
--------------------------------------------------------------------------------
1 i:16817:GGCAG
                                16765   TATACAGGGTGCTGCCCTCTCCCCAGCACTTCAGGGCTTTAGCTGGGAGGGA-----GGCAGTCCACAGG   16829
sample03 52M5I13M                       TATACAGGGTGCTGCCCTCTCCCCAGCACTTCAGGGCTTTAGCTGGGAGGGAGGCAGGGCAGTCCACAGG
--------------------------------------------------------------------------------
1 i:16821:T
                                16758   AGGACACTATACAGGGTGCTGCCCTCTCCCCAGCACTTCAGGGCTTTAGCTGGGAGGGAGGCA-GTC   16823
sample03 63M1I3M3S                      AGGACACTATACAGGGTGCTGCCCTCTCCCCAGCACTTCAGGGCTTTAGCTGGGAGGGAGGCATGTC
--------------------------------------------------------------------------------


Enjoy!


author: erik garrison <erik.garrison@bc.edu>
license: free
